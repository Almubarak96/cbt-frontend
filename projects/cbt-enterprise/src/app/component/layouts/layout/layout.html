
<!-- Top Navbar -->
<nav class="navbar navbar-dark bg-primary navbar-expand-md fixed-top shadow-sm">
  <div class="container-fluid">
    <!-- Sidebar toggle for mobile -->
    <button class="navbar-toggler d-md-none border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar"
      aria-controls="sidebar">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Brand with toggle for desktop -->
    <div class="d-flex align-items-center">
      <button class="btn btn-link text-white d-none d-md-block p-0 me-3" (click)="toggleSidebar()"
        title="Toggle Sidebar">
        <i class="bi bi-list" style="font-size: 1.5rem;"></i>
      </button>
      <a class="navbar-brand fw-bold d-flex align-items-center">
        <i class="bi bi-mortarboard-fill me-2"></i>
        Idanwo CB
      </a>
    </div>

    <!-- User Menu -->
    <div class="navbar-nav ms-auto flex-row align-items-center">
      <div class="nav-item dropdown">
        <a class="nav-link dropdown-toggle text-white d-flex align-items-center" href="#" role="button"
          data-bs-toggle="dropdown" aria-expanded="false">
          <i class="bi bi-person-circle me-2"></i>
          <span class="d-none d-sm-inline">{{ getUserDisplayName() }}</span>
        </a>
        <ul class="dropdown-menu dropdown-menu-end shadow">
          <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a></li>
          <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
          <li>
            <hr class="dropdown-divider">
          </li>
          <li><a class="dropdown-item text-danger cursor" (click)="onLogout()"><i
                class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
        </ul>
      </div>
    </div>
  </div>
</nav>

<div class="layout-wrapper">
  <!-- Sidebar for mobile (offcanvas) -->
  <div class="offcanvas offcanvas-start sidebar-bg" tabindex="-1" id="sidebar">
    <div class="offcanvas-header border-bottom border-light border-opacity-25">
      <div class="d-flex align-items-center">
        <i class="bi bi-mortarboard-fill text-white me-2" style="font-size: 1.5rem;"></i>
        <h5 class="text-white mb-0">Idanwo CB</h5>
      </div>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body p-0">
      <ng-container *ngTemplateOutlet="menuTemplate"></ng-container>

      <!-- Footer in mobile sidebar -->
      <div class="sidebar-footer p-3 border-top border-light border-opacity-25">
        <small class="text-white-50">v1.0.0 • {{ currentYear }}</small>
      </div>
    </div>
  </div>

  <!-- Main Layout Container -->
  <div class="main-layout-container">
    <!-- Permanent sidebar for desktop -->
    <nav class="desktop-sidebar sidebar-bg" [class.sidebar-collapsed]="isSidebarCollapsed">
      <div class="sidebar-header px-3 mb-4">
        <div class="d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center" [class.d-none]="isSidebarCollapsed">
            <i class="bi bi-mortarboard-fill text-white me-2" style="font-size: 1.5rem;"></i>
            <h5 class="text-white mb-0">Idanwo CB</h5>
          </div>
          <button class="btn btn-link text-white p-0" (click)="toggleSidebar()" title="Toggle Sidebar">
            <i class="bi" [class.bi-chevron-left]="!isSidebarCollapsed"
              [class.bi-chevron-right]="isSidebarCollapsed"></i>
          </button>
        </div>
        <div class="text-white-50 small mt-2" [class.d-none]="isSidebarCollapsed">
          <div class="fw-bold">{{ getUserDisplayName() }}</div>
          <div class="opacity-75">{{ getRoleDisplayName() }}</div>
        </div>
      </div>

      <ng-container *ngTemplateOutlet="menuTemplate"></ng-container>

      <!-- Footer in desktop sidebar -->
      <div class="sidebar-footer px-3 py-3 border-top border-light border-opacity-25">
        <small class="text-white-50" [class.d-none]="isSidebarCollapsed">v1.0.0 • {{ currentYear }}</small>
      </div>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content " [class.sidebar-expanded]="!isSidebarCollapsed"
      [class.sidebar-collapsed]="isSidebarCollapsed">
      <div class="content-container">
        <router-outlet></router-outlet>
      </div>
    </main>
  </div>
</div>

<!-- Shared menu template -->
<ng-template #menuTemplate>
  <nav class="nav flex-column px-3">
    <a *ngFor="let item of currentMenu" [routerLink]="item.route" routerLinkActive="active"
      class="nav-link d-flex align-items-center text-decoration-none position-relative"
      [class.sidebar-link-collapsed]="isSidebarCollapsed" data-bs-dismiss="offcanvas">
      <i [class]="item.icon" class="flex-shrink-0"></i>
      <span class="sidebar-label" [class.d-none]="isSidebarCollapsed">{{ item.label }}</span>

      <!-- Badge for notifications -->
      <span *ngIf="item.badge && item.badge > 0 && !isSidebarCollapsed"
        class="badge bg-danger rounded-pill position-absolute translate-middle">
        {{ item.badge }}
      </span>

      <!-- Active indicator -->
      <span class="active-indicator" [class.d-none]="!item.isActive"></span>
    </a>
  </nav>
</ng-template>